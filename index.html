<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Panic Date? â€” Will you go out with me?</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#ff4d6d;--muted:#9aa4b2}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;color:#e6eef8;background:linear-gradient(180deg,#071029 0%, #081827 60%);} 
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:32px}
    .card{background:rgba(255,255,255,0.03);border-radius:18px;padding:28px;max-width:820px;width:100%;backdrop-filter:blur(6px);box-shadow:0 8px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.04);}
    h1{margin:0;font-size:28px}
    h2.name{margin:8px 0 0;font-size:22px;color:var(--accent)}
    p.lead{color:var(--muted);margin-top:8px}
    .grid{display:grid;grid-template-columns:1fr 320px;gap:20px;margin-top:18px}
    .left{padding-right:10px}
    .date-list{display:flex;flex-direction:column;gap:10px}
    .date-card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);cursor:pointer;display:flex;justify-content:space-between;align-items:center}
    .date-card.selected{outline:3px solid rgba(255,77,109,0.14);transform:translateY(-3px)}
    .muted{color:var(--muted);font-size:13px}
    .btn{background:var(--accent);color:white;padding:10px 14px;border-radius:10px;border:none;font-weight:600;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#d7e6f8}
    .right{display:flex;flex-direction:column;align-items:center;gap:12px}
    .count{font-size:22px;font-weight:700}
    .message{margin-top:14px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}
    footer{margin-top:16px;text-align:center;color:var(--muted);font-size:13px}
    canvas.confetti{position:fixed;left:0;top:0;pointer-events:none;z-index:9999}
    @media(max-width:880px){.grid{grid-template-columns:1fr;}.right{order:-1}}
  </style>
</head>
<body>
  <canvas class="confetti"></canvas>
  <div class="wrap">
    <div class="card" role="main">
      <h1>Panic Date? ðŸ’–</h1>
      <h2 class="name">Hey Thandiwe Sithole ðŸ’•</h2>
      <p class="lead">I picked a surprise â€” choose a date (Oct 27â€“31, 2025) and I'll make it unforgettable. Will you go on a panic date with me?</p>
      <div class="grid">
        <div class="left">
          <div class="date-list" id="dateList"></div>
          <div style="margin-top:14px;display:flex;gap:10px">
            <button id="randomBtn" class="btn ghost">Surprise me (pick random)</button>
            <button id="askBtn" class="btn">Ask her now</button>
          </div>
          <div class="message" id="messageBox" aria-live="polite" style="display:none;margin-top:12px"></div>
        </div>
        <aside class="right">
          <div style="text-align:center;padding:12px;border-radius:12px;">
            <div class="count" id="countdown">Pick a date â†’ see countdown</div>
            <div class="muted">Time until the chosen date (Jo'burg timezone)</div>
          </div>
          <div style="width:100%;text-align:center">
            <button id="saveIcs" class="btn ghost">Save to calendar (.ics)</button>
          </div>
        </aside>
      </div>
      <footer>Made with â™¥ â€” choose a date, then press <strong>Ask her now</strong>.</footer>
    </div>
  </div>

  <script>
    const YEAR = 2025;
    const TZ_OFFSET = '+02:00';
    const dates = [27,28,29,30,31].map(d => ({day:d, label:`Oct ${d}, ${YEAR}`}));

    const dateList = document.getElementById('dateList');
    const countdownEl = document.getElementById('countdown');
    const randomBtn = document.getElementById('randomBtn');
    const askBtn = document.getElementById('askBtn');
    const messageBox = document.getElementById('messageBox');
    const saveIcs = document.getElementById('saveIcs');

    let selected = null;

    function renderDates(){
      dateList.innerHTML = '';
      dates.forEach(dt => {
        const el = document.createElement('div');
        el.className = 'date-card';
        el.tabIndex = 0;
        el.innerHTML = `<div><strong>${dt.label}</strong><div class='muted'>Surprise time will be set when you confirm</div></div><div class='muted'>Pick</div>`;
        el.addEventListener('click', ()=>selectDate(dt, el));
        el.addEventListener('keydown', (e)=>{ if(e.key==='Enter') selectDate(dt, el); });
        dateList.appendChild(el);
        dt.el = el;
      });
    }

    function selectDate(dt, el){
      if(selected && selected.el) selected.el.classList.remove('selected');
      selected = dt;
      el.classList.add('selected');
      beginCountdown(dt);
      messageBox.style.display='none';
    }

    function beginCountdown(dt){
      const target = new Date(`${YEAR}-10-${String(dt.day).padStart(2,'0')}T18:30:00${TZ_OFFSET}`);
      updateCountdown();
      if(window._cdInterval) clearInterval(window._cdInterval);
      window._cdInterval = setInterval(updateCountdown,1000);
      function updateCountdown(){
        const now = new Date();
        const diff = target - now;
        if(diff<=0){ countdownEl.textContent = 'It\'s date time!'; clearInterval(window._cdInterval); return; }
        const days=Math.floor(diff/86400000); const hours=Math.floor((diff%86400000)/3600000); const mins=Math.floor((diff%3600000)/60000); const secs=Math.floor((diff%60000)/1000);
        countdownEl.textContent = `${days}d ${hours}h ${mins}m ${secs}s â€” ${dt.label} @ 18:30`;
      }
    }

    randomBtn.addEventListener('click', ()=>{
      const i = Math.floor(Math.random()*dates.length);
      selectDate(dates[i], dates[i].el);
      messageBox.style.display='block';
      messageBox.textContent = `Random pick: ${dates[i].label}. Looks like a plan!`;
    });

    askBtn.addEventListener('click', ()=>{
      if(!selected){ messageBox.style.display='block'; messageBox.textContent = 'Please choose a date (or press Surprise me).'; return; }
      messageBox.style.display='block';
      messageBox.innerHTML = `<strong>Ready.</strong> Sending your question...`;
      setTimeout(()=>{
        messageBox.innerHTML = `<h3 style=\"margin:6px 0 0\">Thandiwe Sithole ðŸ’•, will you go on a panic date with me on ${selected.label}?</h3><p class='muted' style='margin:8px 0 0'>I promise fun, food and a little adventure â€” please say yes ðŸ’–</p><div style='margin-top:10px;display:flex;gap:8px;justify-content:flex-end'><button id='yesBtn' class='btn'>Say 'Yes' (for show)</button><button id='noBtn' class='btn ghost'>Maybe later</button></div>`;
        startConfetti();
        document.getElementById('yesBtn').addEventListener('click', ()=>{ messageBox.innerHTML = `<h3>She said YES! ðŸŽ‰</h3><p class='muted'>Saved to calendar? Click \"Save to calendar\" to add it to your events.</p>`; startConfetti(); });
        document.getElementById('noBtn').addEventListener('click', ()=>{ messageBox.innerHTML = `<h3>It's okay â€” try another date or surprise her later.</h3>`; stopConfetti(); });
      },900);
    });

    saveIcs.addEventListener('click', ()=>{
      if(!selected){ messageBox.style.display='block'; messageBox.textContent = 'Pick a date first.'; return; }
      const dtStartIso = `${YEAR}-10-${String(selected.day).padStart(2,'0')}T18:30:00`;
      const dtEndIso = `${YEAR}-10-${String(selected.day).padStart(2,'0')}T20:30:00`;
      const uid = 'panic-date-'+Date.now();
      const ics = `BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//PanicDate//EN\nBEGIN:VEVENT\nUID:${uid}\nDTSTAMP:${formatIcsDate(new Date())}\nDTSTART:${formatIcsDate(new Date(dtStartIso))}\nDTEND:${formatIcsDate(new Date(dtEndIso))}\nSUMMARY:Panic Date with Thandiwe Sithole\nDESCRIPTION:It's our panic date â€” be ready for a surprise!\nEND:VEVENT\nEND:VCALENDAR`;
      const blob = new Blob([ics], {type:'text/calendar'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = `panic-date-${selected.label.replace(/\s/g,'_')}.ics`; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    function formatIcsDate(d){
      const y = d.getUTCFullYear(); const m = String(d.getUTCMonth()+1).padStart(2,'0'); const day = String(d.getUTCDate()).padStart(2,'0'); const hh = String(d.getUTCHours()).padStart(2,'0'); const mm = String(d.getUTCMinutes()).padStart(2,'0'); const ss = String(d.getUTCSeconds()).padStart(2,'0');
      return `${y}${m}${day}T${hh}${mm}${ss}Z`;
    }

    let confettiInterval = null;
    function startConfetti(){
      const canvas = document.querySelector('canvas.confetti');
      const ctx = canvas.getContext('2d');
      function resize(){ canvas.width = innerWidth; canvas.height = innerHeight; }
      resize(); window.addEventListener('resize', resize);
      const pieces = [];
      for(let i=0;i<120;i++){ pieces.push({x:Math.random()*canvas.width,y:Math.random()*-canvas.height,vy:1+Math.random()*4,vx:(Math.random()-0.5)*3, size:4+Math.random()*8, rot:Math.random()*360}); }
      confettiInterval = setInterval(()=>{
        ctx.clearRect(0,0,canvas.width,canvas.height);
        for(const p of pieces){ p.x += p.vx; p.y += p.vy; p.rot += 6; if(p.y>canvas.height+20){ p.y = -10; p.x = Math.random()*canvas.width; }
          ctx.save(); ctx.translate(p.x,p.y); ctx.rotate((p.rot*Math.PI)/180); ctx.fillStyle = `hsl(${Math.floor(Math.random()*60)+330},70%,60%)`; ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size*0.6); ctx.restore(); }
      }, 30);
      setTimeout(stopConfetti,9000);
    }
    function stopConfetti(){ if(confettiInterval) clearInterval(confettiInterval); const canvas = document.querySelector('canvas.confetti'); const ctx = canvas.getContext('2d'); ctx.clearRect(0,0,canvas.width,canvas.height); }

    renderDates();
    document.addEventListener('keydown', (e)=>{ if(e.key==='?' ) alert('Choose a date and press Ask her now â€” good luck!'); });
  </script>
</body>
</html>
